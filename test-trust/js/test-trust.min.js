var avrScore=$(".average");var sumScore=$(".js-sum");$(function(){var a=$(".hd-subnav");a.on("mouseenter",function(){$(this).find(".sld-area").stop().slideDown(100)});a.on("mouseleave",function(){$(this).find(".sld-area").stop().slideUp(100)});setRadioId();setRadioName($(".subject-answer-list"));setClickStyle();showRightAnswer();showTrustResult();closeWindow();showTrustRank();showSingleRank();showTotalRank();deleteTrust();average(avrScore);sum(sumScore);trustAgain();copyTxt();clearData()});function showTrustResult(){var a=$(".subject-answer-list");$(".trust-btn-result").on("click",function(){if(validate(a)){$(".pop-window").slideDown();$(".window-result").slideDown();var b=$("body").scrollTop();$(window).on("scroll",function(){$(this).scrollTop(b)})}return false})}function validate(b){var a=true;$.each(b,function(c,d){if(!isChecked($(d))){$(".pop-window").slideDown();$(".window-warn").slideDown();$(".warn-text").html("<span>注意：</span>第"+(c+1)+"题尚未估分");$("body").animate({scrollTop:$(d).parents(".trust-subject-item").offset().top});a=false;return false}});return a}function isChecked(b){var a=true;if(b.find("input[type=radio]").length>0){if(!b.find("input[type=radio]:checked").length){a=false}}else{if(b.find("input[type=checkbox]").length>0){if(!b.find("input[type=checkbox]:checked").length){a=false}}else{if(b.find("select").length>0){if(b.find("select").val()==-1){a=false}}}}return a}function trustAgain(){$(".trust-again").on("click",function(){$(window).off("scroll");$(".pop-window").slideUp(100);$(".window-result").slideUp();$("html body").animate({scrollTop:0})})}function showTrustRank(){$(".js-rank").on("click",function(){if($(".pop-window").is(":hidden")){$(".pop-window").slideDown();$(".window-rank").slideDown()}else{$(".window").not(".window-rank").slideUp();$(".window-rank").slideDown()}var a=$("body").scrollTop();$(window).on("scroll",function(){$(this).scrollTop(a)});return false})}function showSingleRank(){$(".single-place button").on("click",function(){$(".window").not(".window-single").slideUp();$(".window-single").slideDown()})}function showTotalRank(){$(".sum-place button").on("click",function(){$(".window").not(".window-total").slideUp();$(".window-total").slideDown()})}function closeWindow(){$(".close-btn").on("click",function(){$(window).off("scroll");$(this).parent(".window-close").parent(".window").slideUp(100).parent(".pop-window").slideUp(100)})}function copyTxt(){$(".copy-btn").on("click",function(){$(this).siblings(".copy-text").select();var b=$(this).siblings(".copy-text").val();var a=new ZeroClipboard.Client();a.setHandCursor(true);a.setText(b);a.addEventListener("mouseUp",function(c){});a.glue("copy-btn")})}function clearData(){var a=null;$(".clearData").on("click",function(){a=$(this).parents(".window");a.append($(".js-html").html());a.find(".window-warning-txt").text("是否清空当前数据？");a.find(".window-warning").slideDown();return false});$(".window").on("click",".warning-yes",function(){$(".window-warning").slideUp(200);$(this).parents(".window-warning").siblings(".mind-table").find("tbody tr").remove();$(this).parents(".window-warning").remove()});$(".window").on("click",".warning-no",function(){$(this).parents(".window-warning").remove()});$(".window").on("click",".window-warning .close-btn",function(){$(this).parents(".window-warning").remove()})}function deleteTrust(){var a=null;$(".js-delete").on("click",function(){var b=$(this).siblings(".order").text().substring(0,2);a=$(this).parents(".window");a.append($(".js-html").html());a.find(".window-warning-txt").text("是否删除"+b+"的估分？");a.find(".window-warning").slideDown();var c=$(this);$(".window").on("click",".warning-yes",function(){$(".window-warning").slideUp(200);c.parents(".item").remove();avrScore.text(average(avrScore));sum(sumScore);$(this).parents(".window-warning").remove()});$(".window").on("click",".warning-no",function(){$(this).parents(".window-warning").remove()});$(".window").on("click",".window-warning .close-btn",function(){$(this).parents(".window-warning").remove()})});$(".js-delete-tr").on("click",function(){var b=$(this).siblings(".disciplines").text();a=$(this).parents(".window");a.append($(".js-html").html());a.find(".window-warning-txt").text("是否删除"+b+"的估分记录？");a.find(".window-warning").slideDown();var c=$(this);$(".window").on("click",".warning-yes",function(){$(".window-warning").slideUp(200);c.parents("tr").remove();$(this).parents(".window-warning").remove();sum(sumScore)});$(".window").on("click",".warning-no",function(){$(".window-warning").slideUp(200);$(this).parents(".window-warning").remove()});$(".window").on("click",".window-warning .close-btn",function(){$(".window-warning").slideUp(100);$(this).parents(".window-warning").remove()})})}function sum(b){var c=b.parent("tr").siblings("tr").find("td.average");var a=0;$.each(c,function(d,e){a+=parseFloat($(e).text())});b.text(a)}function average(a){$.each(a,function(d,f){var b=$(f).prev(".trust-list").find(".js-score");var c=0;var e=0;$.each(b,function(i,g){var h=parseFloat($(g).text());if(h!=0){c+=1;e+=h}});$(f).text(e/(c?c:1))})}function showRightAnswer(){var a=$.each($(".subject-btn"),function(b,d){var c=true;$(d).on("click",function(){if(c){$(this).text("隐藏答案").addClass("active").parents(".trust-subject-item").find(".subject-answer").slideDown();c=false}else{$(this).text("显示答案").removeClass("active").parents(".trust-subject-item").find(".subject-answer").slideUp();c=true}return false})})}function setClickStyle(){$("input[type=radio]").on("click",function(){if($(this).is(":checked")){$(this).siblings("label").addClass("active").parent("li").siblings("li").find("label").removeClass("active");$(this).attr("checked",true).parent("li").siblings("li").find("input[type=radio]").attr("checked",false)}})}function setRadioName(a){a.each(function(b,c){$(c).find("input[type=radio]").attr("name","radio"+b)})}function setRadioId(){var b=$("input[type=radio]");var a=randomNum(b.length);$.each(b,function(c,d){$(d).attr("id","radio"+a[c]);$(d).siblings("label").attr("for","radio"+a[c])})}function randomNum(a){var d=[];for(var c=0;c<a;c++){d[c]=parseInt(Math.random()*a);for(var b=0;b<c;b++){if(d[c]==d[b]){c--;break}}}return d};